

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

     <title>Lab 5</title> 
    <meta name="description" content="Soldering Redux and Random Number Generation">
    <meta name="author" content="Caleb Kemere">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="../assets/themes/bootstrap/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/themes/bootstrap/elec327.css" rel="stylesheet">
  
    <!--[if lt IE 9]>
      <script src="/assets/themes/bootstrap/resources/respond/Respond.min.js"></script>
    <![endif]-->

    <link href="http://elec327.github.io/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="http://elec327.github.io/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>

        <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Rice ELEC327 - Digital Systems Laboratory</a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="../index.html">Home</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="http://elec327.github.io/syllabus">Syllabus</a></li>
      	
      
    
  
    
  



            <li class="dropdown">
              <a href="index.html#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                aria-expanded="false">Labs <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                


  
    
  
    
      
    
  
    
      
      	
      	<li><a href="../lab1/index.html">Lab 1</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab2/index.html">Lab 2</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab3/index.html">Lab 3</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab4/index.html">Lab 4</a></li>
      	
      
    
  
    
      
      	
      	<li class="active"><a href="index.html" class="active">Lab 5</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab6/index.html">Lab 6</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab7/index.html">Lab 7</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab8/index.html">Lab 8</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../lab9/index.html">Lab 9</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../midterm_project/index.html">Project 1 - Midterm</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="../final_project/index.html">Project 2 - Final</a></li>
      	
      
    
  
    
      
    
  



              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>



    <div class="container">
      
<h2 id="not-final-lab-5-building-and-programing-the-mood-ring-pcb-with-randomness">[NOT FINAL] Lab #5: Building and programing the mood ring PCB with randomness</h2>

<p><em>This lab builds on Lab 4 to make a device that flashes an RGB LED in an interesting pattern in
a way that depends on the ambient temperature. The goal is for you to continue to master
combining multiple elements of embedded system architecture while also exploring random number
generation.</em></p>

<h4 id="part-0-building-and-programming-the-mood-ring-pcb">Part 0: Building and programming the Mood Ring PCB</h4>

<p>Begin by assembling your mood ring PCB and programming it with the code you developed for Lab</p>
<ol>
  <li>PAY ATTENTION to the values of resistance you use with the RGB LED. If you make them too
small, it may be fine when running from USB power, but cause problems when running from the
battery.</li>
</ol>

<h4 id="part-1-adding-randomness">Part 1: Adding Randomness</h4>

<p>Next, we will add some randomness to the colors generated by the thermometer. Implement the
function <code class="highlighter-rouge">int rand32(int seed)</code>, which returns a number between 0 and 31. The function should
included one or more static variables that maintain state across function calls such that each
time the function is called, the return value is different. If the int seed argument is zero,
it should be ignored. Otherwise, it should be used to initialize the state variables of the
function. The expectation is that the sequence of values returned following a call with the
same seed value will be the same.</p>

<p>Now, you will change the architecture of your code so that rather than the temperature
deterministically setting the value of the R and B colors, it causes the dynamics of a random
walk through color space to change. The logic should be as follows:</p>

<ol>
  <li>Each cycle of the main timing loop, generate 2 random numbers. Rescale them such that they
are between -15 and +15 (this is assuming you have 255 possible levels of intensity). This will
give two numbers r and b.</li>
  <li>Measure the temperature.</li>
  <li>If the current temperature is colder than it was the last cycle, subtract 8 from r and add 8
to b. If it is warmer, subtract 8 from b and add 8 to r.</li>
  <li>Update the PWM intensities with r and b.</li>
</ol>

<p><strong>BONUS:</strong> If you have implemented control of the green channel, additionally randomly change
the intensity of the green LED.</p>

<p><strong>BONUS:</strong> Create a library which contains the <code class="highlighter-rouge">rand32()</code> function, compile it independently, and
then include it into your project. (This involves putting the function definition in its own
file, creating a header file that contains the function declaration, and compiling it as a
library. You then include the header and the compiled library into your project.)</p>

<p><strong>BONUS:</strong> If you added the external temperature sensor to your PCB, re-implement the
temperature measurement using it.</p>

<p>Save your control code as <code class="highlighter-rouge">random_mood_ring.c</code>. <strong>Create a demo video that shows the shifting
colors. You should demonstrate how changing the temperature causes changes in the color
patterns. Upload your code and the video URL to owlspace. If you want to claim the library
bonus, you should also upload a screenshot of your CCS project with the library included. If
you want to claim the external sensor bonus, make sure you point out how you used it to measure
temperature. Finally, if you used the SMD RGB LED, mention that as well.</strong></p>



      <hr>
      <footer>
        <p>
        &copy; 2017 <a href="http://kemerelab.com">Caleb Kemere</a>
        and <a href="http://www.ece.rice.edu">Rice University ECE</a>
        </p>
      </footer>
    </div>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-55673230-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <script src="../assets/themes/bootstrap/resources/jquery/jquery.min.js"></script>
    <script src="../assets/themes/bootstrap/resources/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>


